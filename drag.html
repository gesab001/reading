<!DOCTYPE html>
<html>
<script src="./angularjs/1.8.0/angular.min.js"></script>
<link rel="stylesheet" href="./bootstrap/4.5.2/css/bootstrap.min.css">
<script src="./jquery/3.5.1/jquery.min.js"></script>
<script src="./popper.js/1.16.0/umd/popper.min.js"></script>
<script src="./bootstrap/4.5.2/js/bootstrap.min.js"></script>
<style>
.mydiv {
  position: absolute;
  z-index: 9;

}

.mydivheader {

  cursor: move;
  z-index: 10;

}
</style>
<body>
<button onclick="goBack()">Go Back</button>
<div id="dragable" class="d-flex flex-row">
</div>

<!--
    <div class="mydiv mydivheader" id="0">p</div>
    <div class="mydiv mydivheader" id="1">o</div>
    <div class="mydiv mydivheader" id="2">r</div>
    <div class="mydiv mydivheader" id="3">t</div>
    <div class="mydiv mydivheader" id="4">i</div>
    <div class="mydiv mydivheader" id="5">o</div>
    <div class="mydiv mydivheader" id="6">n</div>
-->


<script>
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
var word = urlParams.get('word');
var characters = word.split("");
var dragablediv = document.getElementById("dragable");
var topcoord = 50;
var leftcoord = 10;
for (var x=0; x<characters.length; x++){
  var div = document.createElement("DIV");
  div.innerHTML = characters[x];
  div.setAttribute("class", "p-2 mydiv mydivheader btn btn-primary btn-lg");
  div.id = x.toString();
  div.style.top = topcoord + "px";
  div.style.left = leftcoord + "px";
  dragablediv.appendChild(div);
  dragElement(x.toString());
  leftcoord = leftcoord + 35;
 }
/*
topcoord = 200;
leftcoord = 10;
for (var x=0; x<characters.length; x++){
  var div = document.createElement("DIV");
  div.innerHTML = characters[x];
  div.setAttribute("class", "p-2 mydiv mydivheader btn btn-primary btn-lg");

  div.id = x.toString() + "blank";
  div.style.top = topcoord + "px";
  div.style.left = leftcoord + "px";
  dragablediv.appendChild(div);
  dragElement(x.toString());
  leftcoord = leftcoord + 35;
 }
*/
//Make the DIV element draggagle:


function goBack() {
  window.history.back();
}

function dragElement(id) {
 // var positions = getData(id)[id];
  var elmnt = document.getElementById(id);
  var key = id;
  var pos1=0, pos2=0, pos3=0, pos4=0;
 // var pos1 = positions["pos1"], pos2 = positions["pos2"], pos3 = positions["pos3"], pos4 = positions["pos4"];

    /* otherwise, move the DIV from anywhere inside the DIV:*/
    elmnt.onmousedown = dragMouseDown;


  function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
    elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
  }

  function closeDragElement() {
    /* stop moving when mouse button is released:*/
    document.onmouseup = null;
    document.onmousemove = null;
    //var myObj["test"] = { "name":"John", "age":pos1, "car":null };
   // saveToLocalStorage(jsondata);
   
  }

  function saveToLocalStorage(jsondata){
    // Check browser support
    if (typeof(Storage) !== "undefined") {

      localStorage.setItem("draggableletterpositions", JSON.stringify(jsondata));
    
    } 
  }
 
  function getData(id){
     var jsondata = {};
     if("draggableletterpositions" in localStorage){
        jsondata = JSON.parse(localStorage.getItem("draggableletterpositions"));
     } else {
        jsondata = {id: {"pos1": 0, "pos2": 0, "pos3": 0, "pos4": 0}};
     }
     return jsondata;
  }

}



</script>

</body>
</html>
    
